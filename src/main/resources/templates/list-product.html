<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <title>Liste des produits</title>
</head>
<body class=" m-5">

    <header class="flex justify-between items-center mb-6 pb-2 border-b">
        <h1 class="text-3xl font-bold text-gray-800">Nos Produits</h1>
        <a th:href="@{/cart}"
           class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 ">
            Voir le Panier
        </a>
    </header>

    <div th:if="${#lists.isEmpty(productPage.content)}">
        <p>Aucun produit disponible</p>
    </div>

    <div th:unless="${#lists.isEmpty(productPage.content)}" class="space-y-4">
        <div th:each="product : ${productPage.content}"class="border border-gray-300 p-4 mb-4 rounded-md shadow-sm">
            <h2 th:text="${product.name}" class="text-xl font-bold mb-1">Nom du produit</h2>
            <p th:text="${product.description}" class="text-gray-700 mb-2">Description du produit</p>
            <p class="text-lg font-semibold text-blue-700 mb-1" th:text="${#numbers.formatDecimal(product.price, 1, 2, 'POINT')} + ' €'">Prix du produit</p>
            <p class="text-sm text-gray-500" th:text="${product.stock} + ' pièces en stock'">Stock actuel</p>

            <div class="mt-4">
                <form th:action="@{/cart/add}" method="post" class="flex items-center space-x-4">
                    <input type="hidden" name="productId" th:value="${product.id}" />

                    <input type="number" name="quantity" value="1" min="1"
                           class="w-20 p-2 border rounded-md text-center focus:outline-none focus:ring-2 focus:ring-blue-500" />

                    <button type="submit"
                            class="bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600 transition duration-200">
                        Ajouter au panier
                    </button>
                </form>
            </div>
        </div>
    </div>

    <div class="mt-8 text-center">
        <p>Total produits : <span th:text="${productPage.totalElements}"></span></p>
        <th:block th:with="baseUrl=@{/product}">
            <div class="mt-8 ">
                <a th:href="@{|${baseUrl}?pageNumber=${pageNumber - 1}|}"
                   th:if="${!productPage.isFirst()}"
                   class="inline-block px-4 py-2 mx-1 border rounded-md transition-colors duration-200
                          text-blue-600 border-blue-600 hover:bg-blue-600 hover:text-white">
                    &#9664; Précédent
                </a>
                <span th:if="${productPage.isFirst()}"
                      class="inline-block px-4 py-2 mx-1 border rounded-md pointer-events-none opacity-50 bg-gray-200">
                    &#9664; Précédent
                </span>

                <span th:each="pageItem : ${#numbers.sequence(1, productPage.totalPages)}">
                    <a th:if="${pageItem != pageNumber}"
                       th:href="@{|${baseUrl}?pageNumber=${pageItem}|}"
                       th:text="${pageItem}"
                       class="inline-block px-4 py-2 mx-1 border rounded-md transition-colors duration-200
                              text-blue-600 border-blue-600 hover:bg-blue-600 hover:text-white"></a>
                    <span th:if="${pageItem == pageNumber}"
                          th:text="${pageItem}"
                          class="inline-block px-4 py-2 mx-1 border rounded-md bg-blue-600 text-white"></span>
                </span>

                <a th:href="@{|${baseUrl}?pageNumber=${pageNumber + 1}|}"
                   th:if="${!productPage.isLast()}"
                   class="inline-block px-4 py-2 mx-1 border rounded-md transition-colors duration-200
                          text-blue-600 border-blue-600 hover:bg-blue-600 hover:text-white">
                    Suivant &#9654;
                </a>
                <span th:if="${productPage.isLast()}"
                      class="inline-block px-4 py-2 mx-1 border rounded-md pointer-events-none opacity-50 bg-gray-200">
                    Suivant &#9654;
                </span>
            </div>
        </th:block>

    </div>
</body>
</html>